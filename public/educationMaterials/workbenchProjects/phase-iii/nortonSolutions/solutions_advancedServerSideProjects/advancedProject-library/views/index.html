<html>
  <head>
    <title>Personal Library - Norton Solutions Portfolio</title>
    <meta name="description" content="FreeCodeCamp Personal Library Project">
    <link id="favicon" rel="icon" href="https://hyperdev.com/favicon-app.ico" type="image/x-icon">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
  </head>
  <body>
    <div class="container-fluid">
      <header class="bg-success text-white p-4 mb-4">
        <h1 class="display-4">
          <i class="bi bi-book"></i> <b>ISQA Project</b> - Personal Library
        </h1>
        <p class="lead">Norton Solutions FreeCodeCamp Portfolio Project</p>
      </header>
      <div class="row">
        <div class="col-lg-6">
          <div class="card mb-4">
            <div class="card-header bg-info text-white">
              <h2 class="card-title mb-0"><i class="bi bi-list-check"></i> User Stories</h2>
            </div>
            <div class="card-body">
              <ol class="list-group list-group-numbered list-group-flush">
                <li class="list-group-item">Nothing from my website will be cached in my client as a security measure.</li>
                <li class="list-group-item">I will see that the site is powered by 'PHP 4.2.0' even though it isn't as a security measure.</li>
                <li class="list-group-item">I can <b>post</b> a <code>title</code> to <code>/api/books</code> to add a book and returned will be the object with the <code>title</code> and a unique <code>_id</code>.</li>
                <li class="list-group-item">I can <b>get</b> <code>/api/books</code> to retrieve an array of all books containing <code>title</code>, <code>_id</code>, & <code>commentcount</code>.</li>
                <li class="list-group-item">I can <b>get</b> <code>/api/books/{_id}</code> to retrieve a single object of a book containing <code>title</code>, <code>_id</code>, & an array of <code>comments</code> (empty array if no comments present).</li>
                <li class="list-group-item">I can <b>post</b> a <code>comment</code> to <code>/api/books/{_id}</code> to add a comment to a book and returned will be the books object similar to <b>get</b> <code>/api/books/{_id}</code>.</li>
                <li class="list-group-item">I can <b>delete</b> <code>/api/books/{_id}</code> to delete a book from the collection. Returned will be 'delete successful' if successful.</li>
                <li class="list-group-item">If I try to request a book that doesn't exist I will get a 'no book exists' message.</li>
                <li class="list-group-item">I can send a <b>delete</b> request to <code>/api/books</code> to delete all books in the database. Returned will be 'complete delete successful' if successful.</li>
                <li class="list-group-item">All 6 functional tests required are complete and passing.</li>
              </ol>
              <div class="mt-3 text-center">
                <img src='https://cdn.gomix.com/d7932c52-287f-4dae-b175-631fef453000%2FScreen%20Shot%202016-12-16%20at%201.35.56%20AM.png' class="img-fluid rounded" />
              </div>
            </div>
          </div>
        </div>
        
        <div class="col-lg-6">
          <div class="card mb-4">
            <div class="card-header bg-warning text-dark">
              <h2 class="card-title mb-0"><i class="bi bi-gear"></i> Test API Responses</h2>
            </div>
            <div class="card-body">
              <form action="/en/portfolio/api/library/api/books" method="post" class="mb-4 p-3 border border-info rounded">
                <h5 class="text-info"><i class="bi bi-plus-circle"></i> Test POST to /api/books</h5>
                <div class="mb-3">
                  <label class="form-label">Book Title:</label>
                  <input type="text" name="title" class="form-control" placeholder="Enter book title">
                </div>
                <button type="submit" class="btn btn-info">Submit</button>
              </form>
              
              <form action="" method="post" id="commentTest" class="mb-4 p-3 border border-success rounded">
                <h5 class="text-success"><i class="bi bi-chat-dots"></i> Test POST to /api/books/{bookid}</h5>
                <div class="mb-3">
                  <label class="form-label">BookId to comment on:</label>
                  <input type="text" name="id" class="form-control" id="idinputtest" placeholder="Enter book ID">
                </div>
                <div class="mb-3">
                  <label class="form-label">Comment:</label>
                  <input type="text" name="comment" class="form-control" placeholder="Enter your comment">
                </div>
                <button type="submit" class="btn btn-success">Submit</button>
              </form>
              
              <div class="alert alert-info">
                <i class="bi bi-info-circle"></i> Existing books: <a href='/en/portfolio/api/library/api/books' class="alert-link">Click to get details</a>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="container-fluid mt-5">
      <div class="row">
        <div class="col-12">
          <div class="card">
            <div class="card-header bg-primary text-white">
              <h2 class="card-title mb-0"><i class="bi bi-window-desktop"></i> Sample Front-End Interface</h2>
            </div>
            <div class="card-body">
              <form id="newBookForm" class="mb-4 p-3 border border-primary rounded">
                <div class="input-group">
                  <input type="text" id="bookTitleToAdd" name="title" class="form-control" placeholder="Enter new book title">
                  <button type="submit" class="btn btn-primary" id="newBook">
                    <i class="bi bi-plus-circle"></i> Submit New Book!
                  </button>
                </div>
              </form>
              
              <div id='display' class="mb-4"></div>          
              
              <div id='bookDetail' class="p-3 border border-secondary rounded bg-light">
                <p id='detailTitle' class="text-muted mb-3">
                  <i class="bi bi-book"></i> Select a book to see its details and comments
                </p>
                <ol id='detailComments'></ol>
              </div>
              
              <div class="text-center mt-4">
                <button id='deleteAllBooks' class="btn btn-danger">
                  <i class="bi bi-trash"></i> Delete All Books
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <hr style='margin: 50px'>

    <script src="https://redrockcode.com/educationMaterials/frameworks/js/jquery/3.3.1/jquery.min.js"
            crossorigin="anonymous"></script>
    <script src="/public/client.js"></script>           
    <script>
      /*
      *  For #sampleposting to update form action url to test inputs book id
      */
      $(function() {
       $('#commentTest').submit(function(){
         var id = $('#idinputtest').val();
         $(this).attr('action', "/en/portfolio/api/library/api/books/" + id);
       });
      });
      
      $(function() {
        $('#newBookForm').submit(function() {
          event.preventDefault();
          $.ajax({
            url: '/en/portfolio/api/library/api/books',
            type: 'post',
            data: $('#newBookForm').serialize(),
            success: function(data) {
              alert('Book added: ' + data.title + ' (id: ' + data._id + ')');
              // reload book list
              window.location('/en/portfolio/api/library/api/books/');
            }
          });
        });
      })

      // delete all books
      $(function() {
        $('#deleteAllBooks').click(function() {
          if (confirm('Are you sure you want to delete all books?')) {
            $.ajax({
              url: '/en/portfolio/api/library/api/books',
              type: 'delete',
              success: function(data) {
                alert(data);
                loadBooks();
              }
            });
          }
        });
      })
   </script>
  </body>
</html>
